# Implementation Tasks

## 1. 准备工作

- [ ] 1.1 确认所需的 Tauri commands 都已实现(get_setting, set_setting等)
- [ ] 1.2 确认 settingsStore 和 historyStore 的功能完整性
- [ ] 1.3 准备图标资源(各设置标签的图标)

## 2. 基础布局组件

- [ ] 2.1 创建 `SettingsPage.tsx` 主容器组件
- [ ] 2.2 实现左侧导航组件 `SettingsSidebar.tsx`
- [ ] 2.3 实现导航标签组件 `SettingsTab.tsx`
- [ ] 2.4 实现内容区域容器 `SettingsContent.tsx`
- [ ] 2.5 添加标签切换的路由/状态管理
- [ ] 2.6 实现响应式布局(适配窄屏)

## 3. 通用设置面板 (GeneralSettings)

- [ ] 3.1 创建 `GeneralSettings.tsx` 组件
- [ ] 3.2 实现语言选择下拉框
- [ ] 3.3 实现主题选择单选组(Radio Group)
- [ ] 3.4 实现主题切换逻辑(CSS 变量 + data-theme 属性)
- [ ] 3.5 实现自动跟随系统主题功能
- [ ] 3.6 实现自动启动开关(Toggle)
- [ ] 3.7 集成系统自动启动 API
- [ ] 3.8 实现通知开关
- [ ] 3.9 连接 settingsStore 实现数据绑定

## 4. 语音识别设置面板 (VoiceSettings)

- [ ] 4.1 创建 `VoiceSettings.tsx` 组件
- [ ] 4.2 实现模型选择单选组(Base/Small/Medium/Large)
- [ ] 4.3 显示各模型的大小和性能描述
- [ ] 4.4 实现模型下载状态显示(已下载 ✓ / 未下载)
- [ ] 4.5 实现模型下载按钮和下载逻辑
- [ ] 4.6 实现下载进度条组件
- [ ] 4.7 处理下载错误和重试逻辑
- [ ] 4.8 连接 Whisper 模型管理 API

## 5. 快捷键设置面板 (ShortcutSettings)

- [ ] 5.1 创建 `ShortcutSettings.tsx` 组件
- [ ] 5.2 实现快捷键显示输入框
- [ ] 5.3 实现快捷键录制功能(监听键盘事件)
- [ ] 5.4 实现快捷键格式验证
- [ ] 5.5 实现快捷键冲突检测
- [ ] 5.6 实现快捷键保存和应用
- [ ] 5.7 添加快捷键重置按钮
- [ ] 5.8 连接 Tauri 全局快捷键 API

## 6. 历史记录面板 (HistorySettings)

- [ ] 6.1 创建 `HistorySettings.tsx` 组件
- [ ] 6.2 实现历史记录列表组件
- [ ] 6.3 实现虚拟滚动(react-window)
- [ ] 6.4 实现记录项组件(时间、预览、时长)
- [ ] 6.5 实现搜索框和搜索逻辑(带防抖)
- [ ] 6.6 实现记录展开/收起功能
- [ ] 6.7 实现复制按钮功能
- [ ] 6.8 实现删除单条记录功能(带确认对话框)
- [ ] 6.9 实现批量选择功能
- [ ] 6.10 实现批量删除功能
- [ ] 6.11 实现清空所有功能(带二次确认)
- [ ] 6.12 实现分页或懒加载
- [ ] 6.13 连接 historyStore 和数据库 API

## 7. 关于面板 (AboutSettings)

- [ ] 7.1 创建 `AboutSettings.tsx` 组件
- [ ] 7.2 显示应用图标
- [ ] 7.3 显示应用名称和版本号
- [ ] 7.4 显示应用描述
- [ ] 7.5 添加 GitHub 链接(可点击打开浏览器)
- [ ] 7.6 显示开源许可证信息
- [ ] 7.7 添加"检查更新"按钮(占位,未来实现)

## 8. 底部操作栏

- [ ] 8.1 创建底部操作栏组件
- [ ] 8.2 实现"保存"按钮
- [ ] 8.3 实现"重置为默认"按钮
- [ ] 8.4 实现保存逻辑(批量保存所有修改的设置)
- [ ] 8.5 实现重置逻辑(带确认对话框)
- [ ] 8.6 显示操作反馈 Toast

## 9. 主题系统

- [ ] 9.1 定义 CSS 变量颜色主题(浅色/深色)
- [ ] 9.2 实现主题切换工具函数
- [ ] 9.3 实现主题持久化(localStorage)
- [ ] 9.4 实现系统主题监听(prefers-color-scheme)
- [ ] 9.5 为所有组件适配主题样式
- [ ] 9.6 添加主题切换过渡动画

## 10. 错误处理和Toast反馈

- [ ] 10.1 为所有异步操作添加 try-catch
- [ ] 10.2 为数据加载失败添加错误提示
- [ ] 10.3 为保存失败添加错误提示和重试
- [ ] 10.4 为下载失败添加错误提示和重试
- [ ] 10.5 为操作成功添加 Toast 反馈
- [ ] 10.6 确保错误信息对用户友好

## 11. 性能优化

- [ ] 11.1 为设置面板组件添加 React.memo
- [ ] 11.2 为搜索输入添加防抖(300ms)
- [ ] 11.3 为历史记录列表实现虚拟滚动
- [ ] 11.4 优化图标和图片资源
- [ ] 11.5 实现标签页懒加载
- [ ] 11.6 测试并优化首次加载时间(<300ms)

## 12. 可访问性

- [ ] 12.1 为所有交互元素添加 ARIA 标签
- [ ] 12.2 实现键盘导航(Tab 键)
- [ ] 12.3 为焦点元素添加视觉指示
- [ ] 12.4 测试屏幕阅读器兼容性
- [ ] 12.5 确保颜色对比度符合 WCAG AA 标准

## 13. 集成到主应用

- [ ] 13.1 更新 `App.tsx`,替换演示内容为设置页面
- [ ] 13.2 确保从托盘菜单可以打开设置窗口
- [ ] 13.3 实现窗口大小记忆(保存和恢复窗口尺寸)
- [ ] 13.4 测试多窗口情况下的行为

## 14. 测试

- [ ] 14.1 编写 GeneralSettings 组件测试
- [ ] 14.2 编写 VoiceSettings 组件测试
- [ ] 14.3 编写 ShortcutSettings 组件测试
- [ ] 14.4 编写 HistorySettings 组件测试
- [ ] 14.5 编写 AboutSettings 组件测试
- [ ] 14.6 编写主题切换功能测试
- [ ] 14.7 编写快捷键录制功能测试
- [ ] 14.8 编写历史记录搜索功能测试
- [ ] 14.9 测试错误处理场景
- [ ] 14.10 测试性能指标

## 15. 文档和清理

- [ ] 15.1 为所有新组件添加 JSDoc 注释
- [ ] 15.2 删除临时的调试日志
- [ ] 15.3 更新 README.md,添加设置页面截图
- [ ] 15.4 更新开发文档,说明设置项的添加流程
